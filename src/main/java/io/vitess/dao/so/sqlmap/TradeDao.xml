<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="io.vitess.dao.so.TradeDao">

    <resultMap id="TtdTradeResult" type="io.vitess.model.so.Trade">
    </resultMap>

    <!-- 用于select查询公用抽取的列 -->
    <sql id="ttdTradeColumns">
        <![CDATA[
	        	ID as id,
	        	PLATFORM_ORDER_CODE as platformOrderCode,
	        	PLATFORM_ORDER_CREATE_TIME as platformOrderCreateTime,
	        	ERP_SHOP_CODE as companyShop,
	        	IS_SPLIT as isSplit,
	        	ALIPAY_NO as payNo,
	        	ALIPAY_ACCOUNT as payAccount,
	        	ORDER_COUNT as orderCount,
	        	VERSION as version
	    ]]>
    </sql>

    <!-- useGeneratedKeys="true" keyProperty="xxx" for sqlserver and mysql -->
    <insert id="insert" parameterType="io.vitess.model.so.Trade"

            flushCache="true">
        <![CDATA[
		        INSERT INTO
		        t_td_trade (
		        id,
		        	PLATFORM_ORDER_CODE ,
		        	PLATFORM_ORDER_CREATE_TIME ,
		        	ERP_SHOP_CODE ,
		        	IS_SPLIT ,
		        	ALIPAY_NO ,
		        	ALIPAY_ACCOUNT ,
		        	ORDER_COUNT ,
		        	VERSION
		        ) VALUES (
		        #{id,javaType=java.lang.Long,jdbcType=BIGINT} ,
		        	#{platformOrderCode,javaType=String,jdbcType=VARCHAR} ,
		        	#{platformOrderCreateTime,javaType=java.util.Date,jdbcType=TIMESTAMP} ,
		        	#{companyShop,javaType=Long,jdbcType=INTEGER} ,
		        	#{isSplit,javaType=Integer,jdbcType=INTEGER} ,
		        	#{payNo,javaType=String,jdbcType=VARCHAR} ,
		        	#{payAccount,javaType=String,jdbcType=VARCHAR} ,
		        	#{orderCount,javaType=Integer,jdbcType=INTEGER} ,
		        	#{version,javaType=java.util.Date,jdbcType=TIMESTAMP}
		        )
		    ]]>

    </insert>



    <select id="findByPlatformOrderCode" resultType="io.vitess.model.so.Trade">
        select
          td.*
        from
          t_td_trade td
        where
          td.PLATFORM_ORDER_CODE = #{platformOrderCode}
          and td.ERP_SHOP_CODE = #{shopId}
    </select>

    <select id="findById" parameterType="java.lang.Long" resultMap="TtdTradeResult" flushCache="false">
        select <include refid="ttdTradeColumns" />
        <![CDATA[
			    from t_td_trade
		        where
		        ID = #{id}
		    ]]>
    </select>
</mapper>